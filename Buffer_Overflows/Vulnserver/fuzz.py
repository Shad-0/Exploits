#!/usr/bin/python

#Simple fuzzer for VulnServer.
import sys, socket

if len(sys.argv) < 3:
	print "fuzz.py [COMMAND] [PAYLOAD]\n"
	exit(1)
fuzzstring = sys.argv[2]
Buffer=[fuzzstring]	
counter=1	
while	len(Buffer)	<=	10000:
	 payload = fuzzstring * counter	
	 Buffer.append(payload)	
	 counter=counter+1 

for string in Buffer:
         print '[*]Fuzzing ' + sys.argv[1] + ' with %s bytes of  ' % len(string) + fuzzstring + '\n'
	 s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	 s.connect(('192.168.56.102', 9999))
	 response = s.recv(1024)
	 s.send(sys.argv[1] + " " + string + '\r\n')
	 response = s.recv(1024)
	 s.send('EXIT\r\n')
	 s.close()

